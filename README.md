# SeedGan: A Thesis on Generative Models for Agricultural Data Augmentation

This repository contains the code and experiments for a thesis focused on generating synthetic crop images for the purpose of data augmentation. The project explores various generative models, including GANs and Denoising Diffusion Probabilistic Models (DDPM), and provides a suite of tools for data manipulation and analysis.

## Data Source

The primary dataset used for this project is the **Crop and Weed Dataset**, which can be found here:

[https://github.com/cropandweed/cropandweed-dataset/tree/main](https://github.com/cropandweed/cropandweed-dataset/tree/main)

The raw and processed versions of the data used in the various experiments are organized within the `/data` directory.

## Repository Structure

The repository is organized into several key directories, each corresponding to a different part of the research.

-   `/data`: Contains all datasets, including original images, processed versions, and images generated by the models.
-   `/ddpm`: A Denoising Diffusion Probabilistic Model (DDPM) implemented in PyTorch to generate 64x64 pixel crop images.
-   `/rollingCopy`: A collection of powerful Python scripts for data augmentation and analysis, such as stitching images and pasting crops.
-   `/Yolo`: Scripts, configurations, and results related to training YOLO object detection models on the original and augmented datasets.
-   `/DCGAN`, `/lightweightGan`, `/Real-ESRGAN`: Implementations and experiments with other generative models.
-   `/dataManipulation`: Utility scripts for various data preprocessing tasks like format conversion and background removal.
-   `/dataVisualizaton`: Scripts to visualize data, such as drawing bounding boxes on images.

---

## Denoising Diffusion Probabilistic Model (`/ddpm`)

This project aims to create a DDPM using PyTorch to generate new 64x64px images of crops from a custom dataset.

### Setup and Training

**1. Create Conda Environment**
```bash
# Create a new conda environment named 'ddpm'
conda create --name ddpm python=3.9

# Activate the environment
conda activate ddpm
```

**2. Install Dependencies**
First, install PyTorch manually with the correct CUDA version for your system.
```bash
# Example for CUDA 13.0
pip3 install torch torchvision --index-url https://download.pytorch.org/whl/cu130
```
Then, install the rest of the dependencies from the project's `requirements.txt`:
```bash
pip install -r ddpm/requirements.txt
```

**3. Train the Model**
To start training, run the main training script:
```bash
python ddpm/train.py
```
The script saves checkpoints after every epoch, allowing training to be resumed.

**4. Generate Images**
To generate images using the latest trained model, run:
```bash
python ddpm/generate.py
```

---

## Data Augmentation Scripts (`/rollingCopy`)

This directory contains a suite of Python scripts for analyzing and augmenting images of crops.

### `stitch_images.py`

**Purpose:** Creates new images by stitching together halves of other images from the dataset and adjusts corresponding label files.

**Usage:**
```bash
python rollingCopy/stitch_images.py /path/to/your/data_folder
```
-   The `data_folder` should contain `images/` and `labels/` subdirectories.
-   Results are saved in `data_folder/output/`.

### `paste_crops.py`

**Purpose:** A powerful augmentation script that pastes individual crop images onto field images, intelligently placing them to avoid overlap and updating label files.

**Usage:**
```bash
python rollingCopy/paste_crops.py /path/to/your/data_folder [OPTIONS]
```
-   The `data_folder` must contain `images/`, `labels/`, and `crops/` subdirectories.
-   Results are saved in `data_folder/output/`.

**Options:**
-   `--use-distribution`: Resizes pasted crops to match the size distribution of original objects.
-   `--blur-edges`: Applies a feathering/blurring effect to the edges of pasted crops for smoother blending.

**Example:**
```bash
# Paste crops using size distribution and edge blurring
python rollingCopy/paste_crops.py /path/to/data --use-distribution --blur-edges
```

### `analyze_middle.py`

**Purpose:** Analyzes images to count crop objects located on the horizontal middle line.

**Usage:**
```bash
python rollingCopy/analyze_middle.py /path/to/your/data_folder
```

## License

This project is licensed under the terms of the LICENSE file.
